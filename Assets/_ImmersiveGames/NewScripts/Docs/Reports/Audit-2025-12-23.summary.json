{
  "date": "2025-12-23",
  "directories": {
    "newScriptsRoot": "Assets/_ImmersiveGames/NewScripts",
    "legacyScriptsRoot": "Assets/_ImmersiveGames/Scripts",
    "docsRoot": "Assets/_ImmersiveGames/NewScripts/Docs",
    "reportsDir": "Assets/_ImmersiveGames/NewScripts/Docs/Reports"
  },
  "legacyReferences": [
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Bridges/LegacySceneFlow/LegacySceneFlowBridge.cs",
      "type": "Bridge/Adapter",
      "reference": "_ImmersiveGames.Scripts.SceneManagement.*; System.Reflection",
      "severity": "OK",
      "note": "Bridge oficial reflete eventos de Scene Flow legado; reflexão para mapear contextos."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Bridges/LegacySceneFlow/LegacySceneFlowAdapters.cs",
      "type": "Bridge/Adapter",
      "reference": "_ImmersiveGames.Scripts.FadeSystem/SceneManagement; LegacyDependencyManager",
      "severity": "OK",
      "note": "Adapters para loader/fade legados."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/LegacySceneFlowBridgeSmokeQATester.cs",
      "type": "QA/Infra",
      "reference": "_ImmersiveGames.Scripts.SceneManagement.Transition.*",
      "severity": "Suspeito",
      "note": "Acoplamento ao legado fora de Bridges; usado para validar bridge."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Infrastructure/Events/EventBusUtil.cs",
      "type": "Infra",
      "reference": "System.Reflection",
      "severity": "OK",
      "note": "Reflexão para limpar EventBus genérico."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Infrastructure/DI/DependencyInjector.cs",
      "type": "Infra",
      "reference": "System.Reflection",
      "severity": "OK",
      "note": "Reflexão para injeção via atributos."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/NewScriptsInfraSmokeRunner.cs",
      "type": "QA/Infra",
      "reference": "System.Reflection",
      "severity": "OK",
      "note": "Invoca testers via Reflection."
    },
    {
      "file": "Assets/_ImmersiveGames/NewScripts/QA/WorldLifecycleAutoTestRunner.cs",
      "type": "QA/Gameplay",
      "reference": "System.Reflection",
      "severity": "OK",
      "note": "Reflexão para automação de lifecycle."
    }
  ],
  "sceneFlow": {
    "flag": "NEWSCRIPTS_SCENEFLOW_NATIVE",
    "flagLocation": "Assets/_ImmersiveGames/NewScripts/Infrastructure/GlobalBootstrap.cs (IsSceneFlowNativeEnabled)",
    "nativeService": "Assets/_ImmersiveGames/NewScripts/Infrastructure/Scene/SceneTransitionService.cs",
    "bridge": "Assets/_ImmersiveGames/NewScripts/Bridges/LegacySceneFlow",
    "tests": [
      "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/SceneTransitionServiceSmokeQATester.cs",
      "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/LegacySceneFlowBridgeSmokeQATester.cs",
      "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/NewScriptsInfraSmokeRunner.cs"
    ],
    "enablement": "Define NEWSCRIPTS_SCENEFLOW_NATIVE para registrar SceneTransitionService no DI; sem flag, apenas bridge legado é mantido.",
    "bridgeRemovalCriteria": "Flag ativa + QAs verdes + nenhum consumidor dependente do legado (Docs/ADR/ADR-0001-NewScripts-Migracao-Legado.md#bridges-temporários-legacysceneflowbridge)."
  },
  "worldLifecycle": {
    "controller": "Assets/_ImmersiveGames/NewScripts/Infrastructure/World/WorldLifecycleController.cs",
    "baselineRunner": "Assets/_ImmersiveGames/NewScripts/Infrastructure/QA/WorldLifecycleBaselineRunner.cs",
    "autoRunner": "Assets/_ImmersiveGames/NewScripts/QA/WorldLifecycleAutoTestRunner.cs",
    "docs": [
      "Assets/_ImmersiveGames/NewScripts/Docs/WorldLifecycle/WorldLifecycle.md",
      "Assets/_ImmersiveGames/NewScripts/Docs/QA/WorldLifecycle-Baseline-Checklist.md"
    ],
    "triggers": {
      "hardReset": "ContextMenu QA/Reset World Now ou AutoInitializeOnStart",
      "softResetPlayers": "ContextMenu QA/Soft Reset Players Now",
      "baselineRunner": "ContextMenus Run Hard/Soft/Full Baseline; hotkeys F7/F8/F9"
    },
    "expectedLogs": {
      "hard": "Gate acquire/release WorldLifecycle.WorldReset; fases OnBefore/AfterDespawn/Spawn; Reset iniciado/concluído",
      "soft": "Gate flow.soft_reset; PlayersResetParticipant; filtros 'skipped by scope filter'; Soft reset iniciado/concluído"
    },
    "protections": [
      "WorldLifecycleController usa _isResetting para evitar concorrência",
      "WorldLifecycleBaselineRunner bloqueia execuções paralelas (_isRunning/_isGateValidationRunning)",
      "WorldLifecycleRuntimeDriver evita resets duplicados com _ongoingResetTask/_lastContextSignature e gate",
      "WorldLifecycleOrchestrator serializa por ISimulationGateService e limpa cache no finally"
    ]
  },
  "docsOutsideNewScripts": {
    "category1": [],
    "category2": [
      "Assets/_ImmersiveGames/Scripts/**/Docs/*.md (legado)",
      "Assets/_ImmersiveGames/Docs/ADR/ADR-001-world-reset-por-respawn.md",
      "Assets/_ImmersiveGames/Docs/ADR/PlanoWorldGame.md",
      "Assets/_ImmersiveGames/Docs/UTILS-SYSTEMS-GUIDE.md",
      "Assets/_ImmersiveGames/Docs/Generated/ArchitectureAudit.md",
      "Assets/ReplaceSelected/changelog.md",
      "Assets/ReplaceSelected/readme.md",
      "Docs/CHANGELOG.md",
      "README.md",
      "LICENSE.md"
    ],
    "category3": []
  },
  "backlog": {
    "P0": [
      "Ativar NEWSCRIPTS_SCENEFLOW_NATIVE em ambiente de teste e rodar testers de Scene Flow para validar coexistência e preparar remoção do bridge",
      "Eliminar acoplamento direto ao legado no LegacySceneFlowBridgeSmokeQATester (mover para Bridges/QA ou encapsular via adapters)"
    ],
    "P1": [
      "Automatizar checagem de links e localização de docs do NewScripts",
      "Testar alinhamento da symbol NEWSCRIPTS_SCENEFLOW_NATIVE com registro no GlobalBootstrap"
    ],
    "P2": [
      "Publicar auditorias periódicas a partir deste relatório JSON",
      "Revisar docs legados para adicionar ponteiros para a documentação NewScripts"
    ]
  }
}
